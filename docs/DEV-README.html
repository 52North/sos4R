<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>sos4R developer documentation • sos4R</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>



<meta property="og:title" content="sos4R developer documentation" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sos4R</a>
<<<<<<< HEAD
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0.9002</span>
=======
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
>>>>>>> dev
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/sos4R-vignette-01-quickstart.html">sos4R: Accessing Sensor Observation Services from R - Quickstart</a>
    </li>
    <li>
      <a href="articles/sos4R-vignette-02-ogc-sos.html">sos4R: OGC SWE and SOS</a>
    </li>
    <li>
      <a href="articles/sos4R-vignette-03-sos-operations.html">sos4R: SOS Operations</a>
    </li>
    <li>
      <a href="articles/sos4R-vignette-04-extensions.html">sos4R: Extending package functions and advanced configuration</a>
    </li>
    <li>
      <a href="articles/sos4R-vignette-05-wrapper-functions.html">sos4R: Wrapper Functions for easier SOS access</a>
    </li>
    <li>
      <a href="articles/sos4R-vignette-99-services.html">sos4R: List of SOSs</a>
    </li>
  </ul>
</li>
<li>
  <a href="DEV-README.html">Developer Docs</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/52North/sos4R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>sos4R developer documentation</h1>
    </div>

<div id="sos4r-developer-documentation" class="section level1">

<!-- TOC START min:2 max:4 link:true update:true -->
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#package-structure">Package structure</a></li>
<li>
<a href="#important-folders">Important Folders</a>
<ul>
<li><a href="#r">/R</a></li>
<li><a href="#sandbox">/sandbox</a></li>
</ul>
</li>
<li>
<a href="#building-the-vignette-locally">Building the vignette locally</a>
<ul>
<li><a href="#the-goonline-option">The <code>.goOnline</code> option</a></li>
</ul>
</li>
<li><a href="#classes">Classes</a></li>
<li><a href="#tests">Tests</a></li>
<li><a href="#using-docker">Using docker</a></li>
<li>
<a href="#add-features">Add features</a>
<ul>
<li><a href="#how-to-add-a-parser">How to add a parser</a></li>
<li><a href="#how-to-add-an-encoder">How to add an encoder</a></li>
</ul>
</li>
</ul>
<!-- TOC END --><!-- part of this page previously published at https://wiki.52north.org/Geostatistics/Sos4R --><p>This file contains information for developers of the <a href="http://r-project.org/">R</a> package <code>sos4R</code>. Documentation for users can be found in the package’s vignette (see <code><a href="https://www.rdocumentation.org/packages/utils/topics/browseVignettes">browseVignettes("sos4R")</a></code>).</p>
<div id="requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h2>
<ul>
<li>
<strong>System packages (e.g. on Ubuntu 18.04)</strong>
<ul>
<li>r-base-dev</li>
<li>libxml2-dev</li>
<li>libgdal-dev</li>
<li>libproj-dev</li>
<li>libgeos-dev</li>
<li>texinfo</li>
<li>texinfo-doc-nonfree</li>
<li>texlive</li>
<li>texlive-base</li>
<li>texlive-fonts-recommended</li>
<li>texlive-fonts-recommended-doc</li>
<li>texlive-generic-recommended</li>
<li>texlive-latex-base</li>
<li>texlive-latex-base-doc</li>
<li>texlive-latex-extra</li>
<li>texlive-latex-recommended-doc</li>
<li>texlive-pstricks</li>
</ul>
</li>
<li>
<strong>R packages</strong> (see fields Depends and Suggests in <code>DESCRIPTION</code>)</li>
</ul>
</div>
<div id="contribute" class="section level2">
<h2 class="hasAnchor">
<a href="#contribute" class="anchor"></a>Contribute</h2>
<p>Please get in touch with the <a href="https://52north.org/research/rd-communities/geostatistics/">community contact</a> of the geostatistics community and read the <a href="https://52north.org/software/get-involved/">Get Involved page</a> if you want to <em>become a contributor</em> – contributions are welcome!</p>
<p>You can also dive right in and join the chat room: <a href="https://gitter.im/52North/sos4R"><img src="https://badges.gitter.im/52North/sos4R.svg" alt="Join the chat at https://gitter.im/52North/sos4R"></a></p>
<hr>
</div>
<div id="development-versions-and-branches" class="section level2">
<h2 class="hasAnchor">
<a href="#development-versions-and-branches" class="anchor"></a>Development, versions, and branches</h2>
<ul>
<li>Roadmap and release planning is done in <a href="https://github.com/52North/sos4R/projects">projects</a>.</li>
<li>The <strong><code>master</code> branch</strong> is up to date with the version on CRAN. Bugfixes should be based on this branch.</li>
<li>Tasks are developed in <a href="https://trunkbaseddevelopment.com/short-lived-feature-branches/">task or feature branches</a> based on the <strong><code>dev</code> branch</strong>. Pull requests are sent from the features branches to the dev branch once they are complete.</li>
<li>Feature ideas as issues tagged <a href="https://github.com/52North/sos4R/issues?q=is%3Aissue+is%3Aopen+label%3Aenhancement">“enhancement”</a>.</li>
<li>Bugs are issues tagged as <a href="https://github.com/52North/sos4R/issues?q=is%3Aissue+is%3Aopen+label%3Abug">“bugs”</a>.</li>
<li>The package uses <a href="https://semver.org/"><strong>semantic versioning</strong></a>.
<ul>
<li>The current development version should start with <code>.9000</code> <em>after</em> the patch version, see <a href="http://r-pkgs.had.co.nz/description.html#version">R packages versioning</a>.</li>
<li>The development version can be increased <em>extensively</em>, e.g. with each non-trivial commit.</li>
<li>The version must be changed in the files <code>DESCRIPTION</code> and <code>man/sos4R-package.Rd</code> (which is important for releases).</li>
<li>Bugfix versions can be used extensively (for several, or even just one bug) to show users that errors are resolved.</li>
<li>Minor versions shall include several major bug fixes or a considerable addition of tested and working functionality.</li>
<li>Code changes that possibly break existing code shall only be released with a major version change and should be discussed in the developer community beforehand.</li>
</ul>
</li>
</ul>
<p>Users may install the current development version or local branches using respective functions of <a href="https://devtools.r-lib.org/"><code>devtools</code></a>.</p>
<hr>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<div id="news" class="section level3">
<h3 class="hasAnchor">
<a href="#news" class="anchor"></a>News</h3>
<p>The latest changes for every version are documented in the file <code>NEWS.md</code> in the package root directory. Open a preview with <code><a href="https://pkgdown.r-lib.org/reference/build_news.html">pkgdown::build_news()</a></code>.</p>
</div>
<div id="r-function-documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#r-function-documentation" class="anchor"></a>R function documentation</h3>
<p>Package documentation is based on <code>.Rd</code> files (regarding switch to <code>roxygen</code> see <a href="#21">https://github.com/52North/sos4R/issues/21</a>). The file <code>NAMESPACE</code> is <em>not</em> managed by <code>roxygen2</code> either.</p>
</div>
<div id="update-website" class="section level3">
<h3 class="hasAnchor">
<a href="#update-website" class="anchor"></a>Update website</h3>
<p>Knit <code>README.Rmd</code> to create <code>README.md</code>.</p>
<p>Run <a href="https://pkgdown.r-lib.org/">pkgdown</a> from the package directory each time you release your package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">pkgdown<span class="op">::</span><span class="kw"><a href="https://pkgdown.r-lib.org/reference/build_site.html">build_site</a></span>()</a></code></pre></div>
</div>
<div id="build-vignettes" class="section level3">
<h3 class="hasAnchor">
<a href="#build-vignettes" class="anchor"></a>Build vignettes</h3>
<p>The vignettes should build as part of the docs website or package check process. To build single vingettes manually you can use</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">rmarkdown<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rmarkdown/topics/render">render</a></span>(<span class="st">"vignettes/sos4R-vignette-01-quickstart.Rmd"</span>)</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">pkgdown<span class="op">::</span><span class="kw"><a href="https://pkgdown.r-lib.org/reference/build_articles.html">build_article</a></span>(<span class="st">"sos4R-vignette-01-quickstart"</span>)</a></code></pre></div>
<hr>
</div>
</div>
<div id="package-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#package-structure" class="anchor"></a>Package structure</h2>
<p>sos4R follows the regular R extension package structure. General documentation about R package development can be found at the following two websites.</p>
<ul>
<li>R extension packages by Hadley: <a href="http://r-pkgs.had.co.nz/" class="uri">http://r-pkgs.had.co.nz/</a> (well written with tight coupling to devtools and RStudio)</li>
<li>R extension manual: <a href="http://cran.r-project.org/doc/manuals/R-exts.html" class="uri">http://cran.r-project.org/doc/manuals/R-exts.html</a> (generic, extensive)</li>
</ul>
<div id="r" class="section level3">
<h3 class="hasAnchor">
<a href="#r" class="anchor"></a>/R</h3>
<p>The actual source files in the <code>/R</code> directory follow a naming schema:</p>
<ul>
<li>
<code>Class-[NamespacePrefix].R</code> files contain class definitions, which are grouped by OGC specification namespace, like classes for XML types in <code>Class-GML.R</code>, but also generic classes as in <code>Class-SOS.R</code>.
<ul>
<li><a href="https://en.wikipedia.org/wiki/Geography_Markup_Language">GML</a></li>
<li><a href="http://www.opengeospatial.org/ogcna">OGC</a></li>
<li>
<a href="https://en.wikipedia.org/wiki/Observations_and_Measurements">OM</a> (and SAMS - spatial sampling, and SA - sampling)</li>
<li><a href="https://www.opengeospatial.org/standards/owc">OWS</a></li>
<li>[SML](<a href="https://en.wikipedia.org/wiki/SensorML" class="uri">https://en.wikipedia.org/wiki/SensorML</a>
</li>
<li>SOS, additionally split up into versions</li>
<li><a href="https://en.wikipedia.org/wiki/Sensor_Web_Enablement">SWE</a></li>
<li><a href="https://en.wikipedia.org/wiki/WaterML">WML</a></li>
</ul>
</li>
<li>
<code>constants.R</code> contains … constants! No XML element name or parameters string shall be specified outside of this class; constants shall not be changed by the user. Please reconsider every time you write a character string in the code if it should not be a constant. Names of XML types and elements shall always be constants, attribute names can be constants. This file also contains the lists of supported features, like result models and connection methods. Use accessor functions where needed.</li>
<li>
<code>defaults.R</code> contains default settings and values, including parsers, encoders, etc., as well as accessor functions to the defaults</li>
<li>
<code>Generic-methods.R</code> contains <em>all</em> generic method definitions <em>except</em> the ones for accessor functions</li>
<li>
<code>[NamespacePrefix]-methods.R</code> contains methods and used (helper or delegate) functions grouped by OGC specification namespace for…
<ul>
<li>creation methods (constructor functions)</li>
<li>encoding methods</li>
</ul>
</li>
<li>
<code>[NamespacePrefix]-methods-parsing.R</code> contains parsing methods grouped by OGC specification namespace; if there is a very limited number of parsing functions and the file is not very long, the parsing functions may also be in the file <code>[NamespacePrefix]-methods.R</code>.</li>
<li>
<code>[NamespacePrefix]-methods-coercion.R</code> contains coercion methods grouped by OGC specification namespace to map from sos4R’s classes to R objects</li>
<li>
<code>[NamespacePrefix]-methods-accessor.R</code> and <code>[NamespacePrefix]-methods-util.R</code> contains accessor functions (which should be used over direct slot access) or utility functions (which are not well defined what they are in contrast to non-utility functions…) grouped by OGC specification namespace</li>
<li>
<code>SOS-methods.R</code> contains the functions for the operations, like getCapabilities(sos:SOS), and the function that actually does the sending of the request, sosRequest(…).</li>
<li>
<code>SOS-methods-accessor.R</code> contains accessor functions.</li>
<li>
<code>SOS-methods-util.R</code> contains a lot of convenience and accessor functions, and should be used to keep the file <code>SOS-methods.R</code> lucid.</li>
<li>
<code>SOS-methods-plotting.R</code> contains plotting functions.</li>
<li>
<code>PrintShowStructureSummary-methods.R</code> contains functions to override <code>print</code>, <code>str</code>, <code>summary</code> functions and the like; these may go in this file or also into the file where the respective class is defined.</li>
</ul>
</div>
<div id="sandbox" class="section level3">
<h3 class="hasAnchor">
<a href="#sandbox" class="anchor"></a><code>/sandbox</code>
</h3>
<p>In addition to the regular directories, the <code>/sandbox</code> folder contains a wild list of R scripts with tests and demos etc. Code in this directory is not exported from the package but is used during development to test during the implementation of (new) functionality. Please consider using this extensively as a history to be able to resolve problems that occurred before and to document what is working and what not. It is also recommended to run related tests again after (even minor) changes in the code.</p>
<ul>
<li>
<code>testing.R</code> contains tests done during the development of certain functions and is a very good opportunity to (re-)check functionality and keep a history of functionality that is working (at some point in time at least…).</li>
<li>
<code>testing-SOSs(-2.0).R</code> contains tests of connections to different types of SOS and different SOS instances.</li>
</ul>
</div>
<div id="naming-of-functions-defaults-and-constants" class="section level3">
<h3 class="hasAnchor">
<a href="#naming-of-functions-defaults-and-constants" class="anchor"></a>Naming of functions, defaults, and constants</h3>
<p>The following guidelines are a non extensive list of naming rules that were used within the package. Please also browse through the code files before starting to develop new functions to get to know the structures that are already in place so that a good user experience can be ensured.</p>
<ul>
<li>
<strong>Defaults</strong>: <em>sosDefaultXYZ</em>, e.g. <code>sosDefaultCharacterEncoding</code>
</li>
<li>
<strong>Defaults with accessor function:</strong> Follows the same rules, but add a point to the actual variable so that it is not exported and start the function with a capital letter, e.g. <code>.sosDisabledParsers</code> and <code><a href="reference/Defaults.html">SosDisabledParsers()</a></code>
</li>
<li>
<strong>Constants:</strong> Constants for names of XML elements start with a lowercase character string of the namespace prefix, a unique name of the element (where parts like “type” and special characters may be left out, and other descripte elements may be added for clarity), and end with <em>Name</em>, e.g. <code>gmlEnvelopeName &lt;- "Envelope"</code>, <code>ogcGeometryOperandLineStringName &lt;- "gml:LineString"</code>, or <code>ogcTempOpTMEqualsName &lt;- "TM_Equals"</code>.</li>
<li>
<strong>Supported features:</strong> The supported features, like connection methods and supported response modes, shall be accessible by functions starting with SosSupported, e.g. <code>SosSupportedConnectionMethods()</code>.</li>
<li>
<strong>Accessor functions:</strong> Shall start with <em>sos</em>, e.g. <code><a href="reference/SOS.html">sosOfferings(sos:SOS)</a></code>.</li>
<li>
<strong>Functions to access default values</strong>, especially lists and functions with merging feature: Shall start with <em>Sos</em>, e.g. <code><a href="reference/Defaults.html">SosEncodingFunctions()</a></code>.</li>
</ul>
</div>
<div id="classes" class="section level3">
<h3 class="hasAnchor">
<a href="#classes" class="anchor"></a>Classes</h3>
<p>Data models, i.e. requests and responses, are modelled as <strong>S4 classes</strong>. Documentation can be found at the following sites (and others):</p>
<ul>
<li>The S4 object system: <a href="http://adv-r.had.co.nz/S4.html" class="uri">http://adv-r.had.co.nz/S4.html</a> (short, must read)</li>
<li>A (Not So) Short Introduction to S4: <a href="https://cran.r-project.org/doc/contrib/Genolini-S4tutorialV0-5en.pdf" class="uri">https://cran.r-project.org/doc/contrib/Genolini-S4tutorialV0-5en.pdf</a> (not so short)</li>
<li>Classes and Methods in the S Language by Chambers: <a href="http://www.omegahat.org/RSMethods/Intro.pdf" class="uri">http://www.omegahat.org/RSMethods/Intro.pdf</a>
</li>
</ul>
</div>
</div>
<div id="troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting" class="anchor"></a>Troubleshooting</h2>
<ul>
<li>“non-ASCII characters” in a file &gt; find them with <code><a href="https://www.rdocumentation.org/packages/tools/topics/showNonASCII">tools::showNonASCIIfile()</a></code>
</li>
</ul>
</div>
<div id="tests" class="section level2">
<h2 class="hasAnchor">
<a href="#tests" class="anchor"></a>Tests</h2>
<p>Tests are implemented with <a href="http://testthat.r-lib.org/"><code>testthat</code></a>. Run them with</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/test">test</a></span>()</a></code></pre></div>
<p>or by clicking the “Check” button in RStudio (which does more than just running the tests!).</p>
</div>
<div id="using-docker" class="section level2">
<h2 class="hasAnchor">
<a href="#using-docker" class="anchor"></a>Using docker</h2>
<p>In the <a href="docker/">docker</a> folder, a Dockerfile is provided that can be used to set-up an isolated container just for sos4R development. This includes all required dependencies, RStudio as webapplication, and devtools. The current size of the image is ~4.02GB.</p>
<ol>
<li><p>Clone this repository.</p></li>
<li><p>Change to the <code>docker</code> subfolder in any terminal of your choice.</p></li>
<li><p>Perform the following command to build the image locally:<br><code>docker build -t sos4r-rstudio-dev:$(date +%Y-%m-%d) .</code>.<br><em>On windows</em>, you need to replace <code>$(date +%Y-%m-%d)</code> with something useful, like <code>2019-02-27</code>.</p></li>
<li>Start the image as new container using the following command:</li>
</ol>
<pre><code>docker run --name=sos4r-dev --env PASSWORD=r --publish 8787:8787 --volume /YOUR_PATH_TO/sos4R/:/home/rstudio/sos4R -d sos4r-rstudio-dev:2019-02-27</code></pre>
<p>You can start and stop the container by its name <code>sos4r-dev</code>.</p>
<ol>
<li><p>Point your browser to <a href="http://localhost:8787/">http://localhost:8787/</a>.</p></li>
<li><p>Login with <strong>Username</strong> <code>rstudio</code> and <strong>Password</strong> <code>r</code>.<br> If the password is not secure enough, please delete the container via <code>docker stop sos4r-dev; docker rm sos4r-dev</code> and re-run the above <code>docker run ...</code> with a different value for <code>PASSWORD</code>.</p></li>
<li><p>Open the sos4R project via menu <code>File</code> → <code>Open Project</code> → open folder <code>sos4R</code> → select <code>sos4R.Rproj</code>.</p></li>
<li><p>Start developing.</p></li>
</ol>
</div>
<div id="add-features" class="section level2">
<h2 class="hasAnchor">
<a href="#add-features" class="anchor"></a>Add features</h2>
<p>See <a href="#versions-and-branches">Versions and Branches</a> for information about the release flow. In your new feature branch, implement the feature. Add tests.</p>
</div>
<div id="releases" class="section level2">
<h2 class="hasAnchor">
<a href="#releases" class="anchor"></a>Releases</h2>
<p>A new release shall be uploaded to CRAN after testing and under the following procedure:</p>
<ul>
<li>Install the current version of the package from source</li>
<li>Run the <a href="#tests">tests</a> locally and resolve all problems</li>
<li>Run a check locally, e.g. <code><a href="https://www.rdocumentation.org/packages/devtools/topics/check">devtools::check(document = FALSE)</a></code> and fix errors, warnings, and notes</li>
<li>Update NEWS file based on latest commits, add missing changes/updates/notable things</li>
<li>Update the <code>Date</code> field in the <code>DESCRIPTION</code> file to match the release date</li>
<li>Create a PR from <code>dev</code> to <code>master</code> and check the CI status, fix all problems
<ul>
<li><a href="https://travis-ci.org/52North/sos4R" class="uri">https://travis-ci.org/52North/sos4R</a></li>
<li><a href="https://ci.appveyor.com/project/52North/sos4r" class="uri">https://ci.appveyor.com/project/52North/sos4r</a></li>
<li>If there are problems with the <code>devel</code> release of R, you can use a local Docker container to run the checks while fixing them (from the path of the parten folder of <code>sos4R</code>): <code>docker run --rm -it -v $(pwd)/sos4R:/home/sos4R rocker/geospatial:devel bash</code>, switch to <code>/home</code>, then run the commands below (<code>R CMD build</code> &amp; <code>check</code>)</li>
</ul>
</li>
<li>Update version and date in <code>man/sos4R-package.Rd</code>
</li>
<li>Update version in <code>DESCRIPTION</code>
</li>
<li>Update version number in <code>NEWS.md</code>
</li>
<li>Run <strong>checks</strong> again and fix all problems
<ul>
<li>In the parent directory of the project: <code>R CMD build sos4R; R CMD check --as-cran sos4R_&lt;version number&gt;.tar.gz</code> should have no errors, warnings, or notes</li>
<li>
<code>revdepcheck::revdep_check()</code> for checking reverse dependencies</li>
<li>
<code><a href="https://www.rdocumentation.org/packages/devtools/topics/check_win">devtools::check_win_release()</a></code> and <code><a href="https://www.rdocumentation.org/packages/devtools/topics/check_win">devtools::check_win_devel()</a></code> for testing Windows using CRAN infrastructure</li>
<li>
<code>rhub::check_for_cran(email = &lt;...&gt;)</code> for testing for CRAN submissions using RHub infrastructure</li>
<li>(optional) <code>rhub::check(email = &lt;...&gt;)</code> for running checks on different operating systems</li>
</ul>
</li>
<li>Regenerate the website with <code><a href="https://pkgdown.r-lib.org/reference/build_site.html">pkgdown::build_site()</a></code> and re-knit <code>README.Rmd</code>, commit changes</li>
<li>Push changes to <code>dev</code> branch</li>
<li>Read and follow <a href="http://cran.r-project.org/web/packages/policies.html" class="uri">http://cran.r-project.org/web/packages/policies.html</a> and <a href="http://r-pkgs.had.co.nz/release.html#release-check" class="uri">http://r-pkgs.had.co.nz/release.html#release-check</a> again, make necessary changes</li>
<li>Merge the PR</li>
<li>Update your local <code>master</code> to upstream’s <code>master</code> branch -_ Do the actual release_ with <code><a href="https://www.rdocumentation.org/packages/devtools/topics/release">devtools::release()</a></code> (which will ask you again if you did many of the steps before)</li>
<li>Wait for the good news, check where the package is in the queue with <code><a href="https://www.rdocumentation.org/packages/foghorn/topics/cran_incoming">foghorn::cran_incoming(pkg = "sos4R")</a></code>
</li>
<li>When available on CRAN:
<ul>
<li>Create a git tag with the version number using the letter <code>v</code> followed by the version number (see above, must match <code>DESCRIPTION</code>), e.g. <code>v1.2.3</code>, and push it to the main repository</li>
<li>Create a release on GitHub based on the new tag, named just as the version tag, see the file <code>CRAN-RELEASE</code> for the precise commit</li>
<li>Remove the file <code>CRAN-RELEASE</code>
</li>
<li>Checkout the <code>dev</code> branch</li>
<li>Merge <code>upstream/master</code>
</li>
<li>Update the version in <code>DESCRIPTION</code> to a new development version, e.g. from <code>0.3.0</code> to <code>0.4.0.9000</code>
</li>
<li>Email on 52N mailing list(s) (coordinate with 52N staff)</li>
<li>Tweet</li>
</ul>
</li>
</ul>
</div>
</div>

  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Nuest.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

