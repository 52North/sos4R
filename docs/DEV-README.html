<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>sos4R developer documentation • sos4R</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>



<meta property="og:title" content="sos4R developer documentation" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sos4R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/01-quickstart.html">sos4R: Accessing Sensor Observation Services from R -- Quickstart</a>
    </li>
    <li>
      <a href="articles/02-ogc-sos.html">sos4R: OGC SWE and SOS</a>
    </li>
    <li>
      <a href="articles/03-sos-operations.html">sos4R: SOS Operations</a>
    </li>
    <li>
      <a href="articles/04-extensions.html">sos4R: Extending package functions and advanced configuration</a>
    </li>
  </ul>
</li>
<li>
  <a href="DEV-README.html">Developer Docs</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/52North/sos4R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>sos4R developer documentation</h1>
    </div>

<div id="sos4r-developer-documentation" class="section level1">

<p>This file contains information for developers of the <a href="http://r-project.org/">R</a> package <code>sos4R</code>. Documentation for usres can be found in the package’s vignette (see <code><a href="https://www.rdocumentation.org/packages/utils/topics/browseVignettes">browseVignettes("sos4R")</a></code>).</p>
<!-- part of this page previously published at https://wiki.52north.org/Geostatistics/Sos4R -->
<div id="contribute" class="section level2">
<h2 class="hasAnchor">
<a href="#contribute" class="anchor"></a>Contribute</h2>
<p>Please get in touch with the <a href="https://52north.org/research/rd-communities/geostatistics/">community contact</a> of the geostatistics community and read the <a href="https://52north.org/software/get-involved/">Get Involved page</a> if you want to <em>become a contributor</em> – contributions are welcome!</p>
<p>Feature ideas (as issues tagged “enhancement”), roadmap (as milestones) and tasks (issues in the current milestone) as as well as bugs (tagges as “bugs”) are managed on GitHub: <a href="https://github.com/52North/sos4R/issues" class="uri">https://github.com/52North/sos4R/issues</a>.</p>
</div>
<div id="versions-and-branches" class="section level2">
<h2 class="hasAnchor">
<a href="#versions-and-branches" class="anchor"></a>Versions and branches</h2>
<p>The package uses <a href="https://semver.org/">semantic versioning</a>. The current development version should start with <code>.9000</code> <em>after</em> the patch version, see <a href="http://r-pkgs.had.co.nz/description.html#version">R packages versioning</a>. The development version can be increased <em>extensively</em>, e.g. with each non-trivial commit. The version must be changed in the files <code>DESCRIPTION</code> and <code>man/sos4R-package.Rd</code> (which is important for releases).</p>
<p>Bugfix releases can be used extensively (for several, or even just one bug) to show users that errors are resolved. Minor versions shall include several major bug fixes or a considerable addition of tested and working functionality. Code changes that possibly break existing code shall only be released with a major version change and should be discussed in the developer community beforehand.</p>
<p>You can install the current development version or local branches using respective functions of <a href="https://devtools.r-lib.org/"><code>devtools</code></a>.</p>
<p>We use the <a href="https://en.wikipedia.org/wiki/Fork_and_pull_model">“fork &amp; pull” development model</a>. The <strong><code>master</code> branch</strong> is up to date with the version on CRAN. Bugfixes should be based on this branch. If you want to develop further functions for the package always use the up-to-date version from the main repository’s <strong><code>dev</code> branch</strong> and preferably start a new branch in your fork.</p>
</div>
<div id="releases" class="section level2">
<h2 class="hasAnchor">
<a href="#releases" class="anchor"></a>Releases</h2>
<p>A new release shall be uploaded to CRAN after testing and under the following procedure:</p>
<ul>
<li>Run <a href="#tests">tests</a>
</li>
<li>Update version and date in <code>man/sos4R-package.Rd</code>
</li>
<li>Update version in <code>DESCRIPTION</code>
</li>
<li>Create tag with version number</li>
<li>Update NEWS file based on latest commits</li>
<li>Read <a href="http://cran.r-project.org/web/packages/policies.html" class="uri">http://cran.r-project.org/web/packages/policies.html</a> again</li>
<li>Apply <a href="http://r-pkgs.had.co.nz/release.html#release-check" class="uri">http://r-pkgs.had.co.nz/release.html#release-check</a>
</li>
<li>When available on CRAN
<ul>
<li>Notice on 52N mailing list(s)</li>
<li>Publication on blog</li>
</ul>
</li>
</ul>
<p>The following code snippets can make sure everything runs smoothly. On the command line:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ex">R</span> CMD check --as-cran</a></code></pre></div>
<p>In R, use</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/devtools-deprecated">build_win</a></span>()</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">revdepcheck<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/revdepcheck/topics/revdep_check">revdep_check</a></span>()</a></code></pre></div>
<p>You then should do the actual release with</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/release">release</a></span>()</a></code></pre></div>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<div id="news" class="section level3">
<h3 class="hasAnchor">
<a href="#news" class="anchor"></a>News</h3>
<p>The latest changes for every version are documented in the file <code>NEWS.md</code> in the package root directory. Open a preview with <code><a href="https://pkgdown.r-lib.org/reference/build_news.html">pkgdown::build_news()</a></code>.</p>
</div>
<div id="r-function-documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#r-function-documentation" class="anchor"></a>R function documentation</h3>
<p>Package documentation is based on <code>.Rd</code> files (regarding switch to <code>roxygen</code> see <a href="#21">https://github.com/52North/sos4R/issues/21</a>). The file <code>NAMESPACE</code> is <em>not</em> managed by <code>roxygen2</code> either.</p>
</div>
<div id="update-website" class="section level3">
<h3 class="hasAnchor">
<a href="#update-website" class="anchor"></a>Update website</h3>
<p>Knit <code>README.Rmd</code> to create <code>README.md</code>.</p>
<p>Run <a href="https://pkgdown.r-lib.org/">pkgdown</a> from the package directory each time you release your package:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">pkgdown<span class="op">::</span><span class="kw"><a href="https://pkgdown.r-lib.org/reference/build_site.html">build_site</a></span>()</a></code></pre></div>
</div>
<div id="the--goonline-option-in-vignettes" class="section level3">
<h3 class="hasAnchor">
<a href="#the--goonline-option-in-vignettes" class="anchor"></a>The <code>.goOnline</code> option in vignettes</h3>
<p>To reduce download times while building the vignette it can store the responses of the required requests in local files and create the vignette based on these files. By the default, data is downloaded from the 52°North testbed SOS, and this must be done at least once after checking out the project. For this you must set your working directory to <code>sos4R/vignettes</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/getwd">setwd</a></span>(<span class="st">"./vignettes"</span>)</a></code></pre></div>
<p>Afterwards, you can deactivate download and thereby activate using the local files at the beginning of the vignette:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># triggers whether data is downloaded and stored in /vignettes folder</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">.goOnline &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">.verbose &lt;-<span class="st"> </span><span class="ot">FALSE</span></a></code></pre></div>
</div>
</div>
<div id="package-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#package-structure" class="anchor"></a>Package structure</h2>
<p>sos4R follows the regular R extension package structure. General documentation about R package development can be found at the following two websites.</p>
<ul>
<li>R extension packages by Hadley: <a href="http://r-pkgs.had.co.nz/" class="uri">http://r-pkgs.had.co.nz/</a> (well written with tight coupling to devtools and RStudio)</li>
<li>R extension manual: <a href="http://cran.r-project.org/doc/manuals/R-exts.html" class="uri">http://cran.r-project.org/doc/manuals/R-exts.html</a> (generic, extensive)</li>
</ul>
<div id="r" class="section level3">
<h3 class="hasAnchor">
<a href="#r" class="anchor"></a>/R</h3>
<p>The actual source files in the <code>/R</code> directory follow a naming schema:</p>
<ul>
<li>
<code>Class-[NamespacePrefix].R</code> files contain class definitions, which are grouped by OGC specification namespace, like classes for XML types in <code>Class-GML.R</code>, but also generic classes as in <code>Class-SOS.R</code>.
<ul>
<li><a href="https://en.wikipedia.org/wiki/Geography_Markup_Language">GML</a></li>
<li><a href="http://www.opengeospatial.org/ogcna">OGC</a></li>
<li>
<a href="https://en.wikipedia.org/wiki/Observations_and_Measurements">OM</a> (and SAMS - spatial sampling, and SA - sampling)</li>
<li><a href="https://www.opengeospatial.org/standards/owc">OWS</a></li>
<li>[SML](<a href="https://en.wikipedia.org/wiki/SensorML" class="uri">https://en.wikipedia.org/wiki/SensorML</a>
</li>
<li>SOS, additionally split up into versions</li>
<li><a href="https://en.wikipedia.org/wiki/Sensor_Web_Enablement">SWE</a></li>
<li><a href="https://en.wikipedia.org/wiki/WaterML">WML</a></li>
</ul>
</li>
<li>
<code>constants.R</code> contains … constants! No XML element name or parameters string shall be specified outside of this class; constants shall not be changed by the user. Please reconsider every time you write a character string in the code if it should not be a constant. Names of XML types and elements shall always be constants, attribute names can be constants. This file also contains the lists of supported features, like result models and connection methods. Use accessor functions where needed.</li>
<li>
<code>defaults.R</code> contains default settings and values, including parsers, encoders, etc., as well as accessor functions to the defaults</li>
<li>
<code>Generic-methods.R</code> contains <em>all</em> generic method definitions</li>
<li>
<code>[NamespacePrefix]-methods.R</code> contains methods and used (helper or delegate) functions grouped by OGC specification namespace for…
<ul>
<li>creation methods (constructor functions)</li>
<li>encoding methods</li>
</ul>
</li>
<li>
<code>[NamespacePrefix]-methods-parsing.R</code> contains parsing methods grouped by OGC specification namespace; if there is a very limited number of parsing functions and the file is not very long, the parsing functions may also be in the file <code>[NamespacePrefix]-methods.R</code>.</li>
<li>
<code>[NamespacePrefix]-methods-coercion.R</code> contains coercion methods grouped by OGC specification namespace to map from sos4R’s classes to R objects</li>
<li>
<code>[NamespacePrefix]-methods-accessor.R</code> and <code>[NamespacePrefix]-methods-util.R</code> contains accessor functions (which should be used over direct slot access) or utility functions (which are not well defined what they are in contrast to non-utility functions…) grouped by OGC specification namespace</li>
<li>
<code>SOS-methods.R</code> contains the functions for the operations, like getCapabilities(sos:SOS), and the function that actually does the sending of the request, sosRequest(…).</li>
<li>
<code>SOS-methods-accessor.R</code> contains accessor functions.</li>
<li>
<code>SOS-methods-util.R</code> contains a lot of convenience and accessor functions, and should be used to keep the file <code>SOS-methods.R</code> lucid.</li>
<li>
<code>SOS-methods-plotting.R</code> contains plotting functions.</li>
<li>
<code>PrintShowStructureSummary-methods.R</code> contains just that</li>
</ul>
</div>
<div id="sandbox" class="section level3">
<h3 class="hasAnchor">
<a href="#sandbox" class="anchor"></a>/sandbox</h3>
<p>In addition to the regular directories, the <code>/sandbox</code> folder contains a wild list of R scripts with tests and demos etc. Code in this directory is not exported from the package but is used during development to test during the implementation of (new) functionality. Please consider using this extensively as a history to be able to resolve problems that occurred before and to document what is working and what not. It is also recommended to run related tests again after (even minor) changes in the code.</p>
<ul>
<li>
<code>testing.R</code> contains tests done during the development of certain functions and is a very good opportunity to (re-)check functionality and keep a history of functionality that is working (at some point in time at least…).</li>
<li>
<code>testing-SOSs.R</code> contains tests of connections to different types of SOS and different SOS instances.</li>
<li>
<code>packaging.R</code> contains the functions for creating package documentation and should be used as the spot to collect useful functions and workflows around future documentation and the packaging process.</li>
</ul>
</div>
<div id="naming-of-functions-defaults-and-constants" class="section level3">
<h3 class="hasAnchor">
<a href="#naming-of-functions-defaults-and-constants" class="anchor"></a>Naming of functions, defaults, and constants</h3>
<p>The following guidelines are a non extensive list of naming rules that were used within the package. Please also browse through the code files before starting to develop new functions to get to know the structures that are already in place so that a good user experience can be ensured.</p>
<ul>
<li>
<strong>Defaults</strong>: <em>sosDefaultXYZ</em>, e.g. <code>sosDefaultCharacterEncoding</code>
</li>
<li>
<strong>Defaults with accessor function:</strong> Follows the same rules, but add a point to the actual variable so that it is not exported and start the function with a capital letter, e.g. <code>.sosDisabledParsers</code> and <code><a href="reference/Defaults.html">SosDisabledParsers()</a></code>
</li>
<li>
<strong>Constants:</strong> Constants for names of XML elements start with a lowercase character string of the namespace prefix, a unique name of the element (where parts like “type” and special characters may be left out, and other descripte elements may be added for clarity), and end with <em>Name</em>, e.g. <code>gmlEnvelopeName &lt;- "Envelope"</code>, <code>ogcGeometryOperandLineStringName &lt;- "gml:LineString"</code>, or <code>ogcTempOpTMEqualsName &lt;- "TM_Equals"</code>.</li>
<li>
<strong>Supported features:</strong> The supported features, like connection methods and supported response modes, shall be accessible by functions starting with SosSupported, e.g. <code>SosSupportedConnectionMethods()</code>.</li>
<li>
<strong>Accessor functions:</strong> Shall start with <em>sos</em>, e.g. <code><a href="reference/SOS.html">sosOfferings(sos:SOS)</a></code>.</li>
<li>
<strong>Functions to access default values</strong>, especially lists and functions with merging feature: Shall start with <em>Sos</em>, e.g. <code><a href="reference/Defaults.html">SosEncodingFunctions()</a></code>.</li>
</ul>
</div>
</div>
<div id="classes" class="section level2">
<h2 class="hasAnchor">
<a href="#classes" class="anchor"></a>Classes</h2>
<p>Data models, i.e. requests and responses, are modelled as <strong>S4 classes</strong>. Documentation can be found at the following sites (and others):</p>
<ul>
<li>The S4 object system: <a href="http://adv-r.had.co.nz/S4.html" class="uri">http://adv-r.had.co.nz/S4.html</a> (short, must read)</li>
<li>A (Not So) Short Introduction to S4: <a href="https://cran.r-project.org/doc/contrib/Genolini-S4tutorialV0-5en.pdf" class="uri">https://cran.r-project.org/doc/contrib/Genolini-S4tutorialV0-5en.pdf</a> (not so short)</li>
<li>Classes and Methods in the S Language: <a href="http://www.omegahat.org/RSMethods/Intro.pdf" class="uri">http://www.omegahat.org/RSMethods/Intro.pdf</a> (by Chambers!)</li>
</ul>
</div>
<div id="troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting" class="anchor"></a>Troubleshooting</h2>
<ul>
<li>“non-ASCII characters” &gt; find them with <code><a href="https://www.rdocumentation.org/packages/tools/topics/showNonASCII">tools::showNonASCIIfile()</a></code>
</li>
</ul>
</div>
<div id="tests" class="section level2">
<h2 class="hasAnchor">
<a href="#tests" class="anchor"></a>Tests</h2>
<p>Tests are implemented with <a href="http://testthat.r-lib.org/"><code>testthat</code></a>. Run them with</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/test">test</a></span>()</a></code></pre></div>
<p>or by clicking the “Check” button in RStudio (which does more than just running the tests!).</p>
</div>
<div id="add-features" class="section level2">
<h2 class="hasAnchor">
<a href="#add-features" class="anchor"></a>Add features</h2>
<p>See <a href="#versions-and-branches">Versions and Branches</a> for information about the release flow. In your new feature branch, implement the feature. Add tests.</p>
<div id="how-to-add-a-parser" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-add-a-parser" class="anchor"></a>How to add a parser</h3>
<ul>
<li>by element name</li>
<li>by mime type</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="reference/Defaults.html">SosParsingFunctions</a></span>()</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># add a local parser</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="reference/Defaults.html">SosParsingFunctions</a></span>(<span class="st">"TimeseriesKVP"</span> =<span class="st"> </span><span class="cf">function</span>() { ... })</a></code></pre></div>
</div>
<div id="how-to-add-an-encoder" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-add-an-encoder" class="anchor"></a>How to add an encoder</h3>
<p>…</p>
</div>
</div>
</div>

  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Nuest.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

