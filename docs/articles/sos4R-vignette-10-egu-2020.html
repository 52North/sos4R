<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessing environmental time series data in R from Sensor Observation Services with ease • sos4R</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Accessing environmental time series data in R from Sensor Observation Services with ease">
<meta property="og:description" content="sos4R">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sos4R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sos4R.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sos4R-vignette-02-ogc-sos.html">OGC SWE and SOS</a>
    </li>
    <li>
      <a href="../articles/sos4R-vignette-03-sos-operations.html">SOS Operations</a>
    </li>
    <li>
      <a href="../articles/sos4R-vignette-04-extensions.html">Extending sos4R and advanced configuration</a>
    </li>
    <li>
      <a href="../articles/sos4R-vignette-05-wrapper-functions.html">Wrapper Functions for easier SOS access</a>
    </li>
    <li>
      <a href="../articles/sos4R-vignette-10-egu-2020.html">EGU2020 Blog Post</a>
    </li>
    <li>
      <a href="../articles/sos4R-vignette-99-services.html">List of SOS services</a>
    </li>
  </ul>
</li>
<li>
  <a href="../DEV-README.html">Developer Docs</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/52North/sos4R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sos4R-vignette-10-egu-2020_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Accessing environmental time series data in R from Sensor Observation Services with ease</h1>
                        <h4 class="author">Daniel Nüst, Institute for Geoinformatics, Münster, Germany (<a href="mailto:d.n@wwu.de" class="email">d.n@wwu.de</a>)</h4>
                        <h4 class="author">Eike H. Jürrens, 52°North GmbH, Münster, Germany (<a href="mailto:e.h.juerrens@52north.org" class="email">e.h.juerrens@52north.org</a>)</h4>
                        <h4 class="author">Benedikt Gräler, 52°North GmbH, Münster, Germany (<a href="mailto:b.graeler@52north.org" class="email">b.graeler@52north.org</a>)</h4>
                        <h4 class="author">Simon Jirka, 52°North GmbH, Münster, Germany (<a href="mailto:s.jirka@52north.org" class="email">s.jirka@52north.org</a>)</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/52North/sos4R/blob/master/vignettes/sos4R-vignette-10-egu-2020.Rmd"><code>vignettes/sos4R-vignette-10-egu-2020.Rmd</code></a></small>
      <div class="hidden name"><code>sos4R-vignette-10-egu-2020.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Time series data of in-situ measurements are the key to many environmental studies. The first challenge in any analysis typically arises when the data needs to be imported into the analysis framework. Standardization is one way to lighten this burden. Unfortunately, relevant interoperability standards might be challenging for non-IT experts as long as they are not dealt with behind the scenes of a client application. sos4R comprises a client that can connect to an SOS server. The user can use it to query data from SOS instances using simple R function calls. A convenience layer enables R users to integrate observation data from data access servers compliant with the SOS standard without any knowledge about the underlying technical standards. To further improve the usability for non-SOS experts, a recent sos4R update includes a set of wrapper functions, which remove complexity and technical language specific to OGC specifications. This update also features specific consideration of the OGC SOS 2.0 Hydrology Profile and thereby opens up a new scientific domain. One standard to provide access to environmental time series data is the Sensor Observation Service (<a href="https://en.wikipedia.org/wiki/Sensor_Observation_Service">SOS</a>) specification published by the Open Geospatial Consortium (<a href="https://www.ogc.org/">OGC</a>). SOS instances are currently used in a broad range of applications such as hydrology, air quality monitoring, and ocean sciences. Data sets provided via an SOS interface can be found around the globe from Europe to New Zealand. The R package sos4R (Nüst et al., 2011) is an extension package for the R environment for statistical computing and visualization (<a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a>), which has been demonstrated as a powerful tool for conducting and communicating geospatial research (cf. Pebesma et al., 2012; ). We demonstrate how the abstraction provided in the client library makes sensor observation data accessible and further show how sos4R allows the seamless integration of distributed observations data, i.e., across organisational boundaries, into transparent and reproducible data analysis workflows. In our presentation, we illustrate use cases and examples building upon sos4R easing the access of time series data in an R and Shiny (<a href="https://shiny.rstudio.com/" class="uri">https://shiny.rstudio.com/</a>) context.</p>
    </div>
    
<div id="preface" class="section level1">
<h1 class="hasAnchor">
<a href="#preface" class="anchor"></a>Preface</h1>
<p>With EGU 2020 cancelled, this blog post elaborates on the abstract submitted by the 52°North software project <code>sos4R</code> development team. See the program entry for the abstract <a href="https://meetingorganizer.copernicus.org/EGU2020/EGU2020-19453.html">EGU2020-19453 in the official programme</a>. Please refer to this work by citing the DOI <a href="https://doi.org/10.5194/egusphere-egu2020-19453"><code>https://doi.org/10.5194/egusphere-egu2020-19453</code></a>.</p>
<p>This document is distributed under the Creative Commons Attribution 4.0 International License.</p>
<div class="figure">
<img src="MO_16.png" alt=""><p class="caption">CC-BY 4.0</p>
</div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Time series data of in-situ measurements are the key to many environmental studies. The first challenge in any analysis typically arises when the data needs to be imported into the analysis framework. Standardization is one way to lighten this burden. Unfortunately, relevant interoperability standards might be challenging for non-IT experts as long as they are not dealt with behind the scenes of a client application. One standard to provide access to environmental time series data is the Sensor Observation Service (<a href="https://en.wikipedia.org/wiki/Sensor_Observation_Service">SOS</a>) specification published by the Open Geospatial Consortium (<a href="https://www.ogc.org/">OGC</a>). SOS instances are currently used in a broad range of applications such as hydrology, air quality monitoring, and ocean sciences. Data sets provided via an SOS interface can be found around the globe from Europe to New Zealand.</p>
<p>The R package <a href="https://52north.github.io/sos4R/">sos4R</a> (Nüst et al., 2011) is an extension package for the R environment for statistical computing and visualization (<a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a>), which has been demonstrated as a powerful tool for conducting and communicating geospatial research (cf. Pebesma et al., 2012). The features presented in this article are available in the new release version <code>0.4</code> <a href="https://cran.r-project.org/package=sos4R">on CRAN</a>.</p>
</div>
<div id="access-sensor-data-with-sos4r" class="section level1">
<h1 class="hasAnchor">
<a href="#access-sensor-data-with-sos4r" class="anchor"></a>Access sensor data with sos4R</h1>
<p>sos4R comprises a client that can connect to an SOS server. The user can use it to query data from SOS instances using simple R function calls. The following example demonstrates some core operations: connect to an SOS, request data availability information and sensor metadata, and retrieve the actual data:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"sos4R"</span>)
<span class="no">fluggs</span> <span class="kw">=</span> <span class="fu"><a href="../reference/SOS.html">SOS</a></span>(
  <span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://fluggs.wupperverband.de/sos2/service"</span>,
  <span class="kw">binding</span> <span class="kw">=</span> <span class="st">"KVP"</span>,
  <span class="kw">version</span> <span class="kw">=</span> <span class="st">"2.0.0"</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">sensor2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DescribeSensor.html">describeSensor</a></span>(
  <span class="kw">sos</span> <span class="kw">=</span> <span class="no">fluggs</span>,
  <span class="kw">procedure</span> <span class="kw">=</span> <span class="fu"><a href="../reference/SOS.html">sosProcedures</a></span>(<span class="no">fluggs</span>)[<span class="fl">2</span>],
  <span class="kw">outputFormat</span> <span class="kw">=</span> <span class="st">"http://www.opengis.net/sensorML/1.0.1"</span>)
<span class="no">sensor2</span>
<span class="co">## Object of class SensorML (see @xml for full document).</span>
<span class="co">##      ID:  NA </span>
<span class="co">##  name: NA </span>
<span class="co">##  description: NA </span>
<span class="co">##  coords:  </span>
<span class="co">##  boundedBy: 2569725.188, 5655230, 2610202.779, 5683593 </span>
<span class="co">##  validTime:</span></pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">fluggs_data_availability</span> <span class="kw">=</span> <span class="fu"><a href="../reference/GetDataAvailability.html">getDataAvailability</a></span>(<span class="no">fluggs</span>)
<span class="no">fluggs_data_availability</span>[<span class="fl">1</span>:<span class="fl">2</span>]
<span class="co">## [[1]]</span>
<span class="co">## Object of class DataAvailabilityMember: </span>
<span class="co">##   Procedure            :  2m_Tiefe </span>
<span class="co">##   Observed Property    :  Wassertemperatur </span>
<span class="co">##   Features Of Interest :  Neyetalsperre_Absperrbauwerk </span>
<span class="co">##   Phenomenon Time      :  GmlTimePeriod: [ GmlTimePosition [ time: 2010-07-14 11:00:00 ]</span>
<span class="co">##  --&gt; GmlTimePosition [ time: 2020-06-24 11:00:00 ] ] </span>
<span class="co">## </span>
<span class="co">## [[2]]</span>
<span class="co">## Object of class DataAvailabilityMember: </span>
<span class="co">##   Procedure            :  2m_Tiefe </span>
<span class="co">##   Observed Property    :  Wassertemperatur </span>
<span class="co">##   Features Of Interest :  Grosse_Dhuenn-Talsperre_Absperrbauwerk </span>
<span class="co">##   Phenomenon Time      :  GmlTimePeriod: [ GmlTimePosition [ time: 2010-08-24 23:00:00 ]</span>
<span class="co">##  --&gt; GmlTimePosition [ time: 2020-07-07 22:59:00 ] ]</span></pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">fluggs_offerings</span> <span class="kw">=</span> <span class="fu"><a href="../reference/SOS.html">sosOfferings</a></span>(<span class="no">fluggs</span>)
<span class="no">fluggs_obs_jan_2019</span> <span class="kw">=</span> <span class="fu"><a href="../reference/GetObservation.html">getObservation</a></span>(<span class="no">fluggs</span>, <span class="kw">offering</span> <span class="kw">=</span> <span class="no">fluggs_offerings</span><span class="kw">[[</span><span class="fl">1</span>]],
               <span class="kw">eventTime</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sosCreate.html">sosCreateTime</a></span>(<span class="no">fluggs</span>, <span class="st">"2019-01-01::2019-01-31"</span>),
               <span class="kw">responseFormat</span> <span class="kw">=</span> <span class="st">"http://www.opengis.net/om/2.0"</span>)
<span class="no">result</span> <span class="kw">=</span> <span class="fu"><a href="../reference/OmObservation.html">sosResult</a></span>(<span class="no">fluggs_obs_jan_2019</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">result</span>)
<span class="co">##        °C       </span>
<span class="co">##  Min.   :0.000  </span>
<span class="co">##  1st Qu.:4.150  </span>
<span class="co">##  Median :4.900  </span>
<span class="co">##  Mean   :4.682  </span>
<span class="co">##  3rd Qu.:5.300  </span>
<span class="co">##  Max.   :6.129</span></pre></body></html></div>
<p>However, these functions use terms and operations specific to the OGC services and the SOS standard. They also require some knowledge about working combinations for requests. Therefore, a new sos4R release provides a convenience layer for R users to integrate observation data from data access servers compliant with the SOS standard without any knowledge about the underlying technical standards. This update also features specific consideration of the <a href="https://docs.opengeospatial.org/bp/14-004r1/14-004r1.html">OGC SOS 2.0 Hydrology Profile</a> and thereby opens up a new scientific domain.</p>
<p>Especially for non-SOS experts, the wrapper functions remove complexity and technical language specific to OGC specifications, e.g., “FOI”, or “procedure”. They use more generic terms. These are easily accessible for all users, especially for those without a strong knowledge of the OGC Sensor Web Enablement standards (see <a href="https://52north.github.io/sos4R/articles/sos4R-vignette-02-ogc-sos.html">“OGC SWE and SOS”</a> vignette for details). In general, these functions always return an object of class <code>data.frame</code>, even if the result is only a list. In this case the <code>data.frame</code> has one column.</p>
<p>The following code chunks demonstrate a request for the same data as above, but use the new wrapper functions.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">fluggs_sites</span> <span class="kw">=</span> <span class="fu"><a href="../reference/sites.html">sites</a></span>(<span class="kw">sos</span> <span class="kw">=</span> <span class="no">fluggs</span>, <span class="kw">includePhenomena</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="co">## Warning in showSRID(uprojargs, format = "PROJ", multiline = "NO"): Discarded</span>
<span class="co">## datum Deutsches_Hauptdreiecksnetz in CRS definition</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"kableExtra"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/reexports.html">kable</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">fluggs_sites</span>))</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
siteID
</th>
<th style="text-align:left;">
Abfluss
</th>
<th style="text-align:left;">
Elektrische_Leitfaehigkeit
</th>
<th style="text-align:left;">
Luftfeuchte
</th>
<th style="text-align:left;">
Lufttemperatur
</th>
<th style="text-align:left;">
Niederschlagshoehe
</th>
<th style="text-align:left;">
pH.Wert
</th>
<th style="text-align:left;">
Sauerstoffgehalt
</th>
<th style="text-align:left;">
Speicherfuellstand
</th>
<th style="text-align:left;">
Speicherinhalt
</th>
<th style="text-align:left;">
Truebung
</th>
<th style="text-align:left;">
Wasserstand
</th>
<th style="text-align:left;">
Wassertemperatur
</th>
<th style="text-align:right;">
lon
</th>
<th style="text-align:right;">
lat
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Barmen_Wupperverband_Hauptverwaltung
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2584104
</td>
<td style="text-align:right;">
5681938
</td>
</tr>
<tr>
<td style="text-align:left;">
Bever-Talsperre
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2595610
</td>
<td style="text-align:right;">
5668481
</td>
</tr>
<tr>
<td style="text-align:left;">
Bever-Talsperre_Absperrbauwerk
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
2595712
</td>
<td style="text-align:right;">
5668454
</td>
</tr>
<tr>
<td style="text-align:left;">
Bever-Talsperre_Windenhaus
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2596169
</td>
<td style="text-align:right;">
5668269
</td>
</tr>
<tr>
<td style="text-align:left;">
Beyenburg
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2590760
</td>
<td style="text-align:right;">
5680180
</td>
</tr>
<tr>
<td style="text-align:left;">
Brucher-Talsperre
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2609207
</td>
<td style="text-align:right;">
5661809
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">phenomena</span> <span class="kw">=</span> <span class="fu"><a href="../reference/phenomena.html">phenomena</a></span>(
  <span class="kw">sos</span> <span class="kw">=</span> <span class="no">fluggs</span>,
  <span class="kw">includeTemporalBBox</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">includeSiteId</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">watertemp_phenomena</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">phenomena</span>,
                             <span class="no">phenomenon</span> <span class="kw">==</span> <span class="st">"Wassertemperatur"</span>)

<span class="co"># function takes R date/time objects as input</span>
<span class="no">timeBegin</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(<span class="st">"2018-01-01"</span>)
<span class="no">timeEnd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(<span class="st">"2018-03-01"</span>)

<span class="no">observationData</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getData.html">getData</a></span>(
  <span class="kw">sos</span> <span class="kw">=</span> <span class="no">fluggs</span>,
  <span class="kw">sites</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">fluggs_sites</span>, <span class="no">Wassertemperatur</span> <span class="kw">==</span> <span class="fl">TRUE</span>),
  <span class="kw">phenomena</span> <span class="kw">=</span> <span class="no">watertemp_phenomena</span>,
  <span class="kw">begin</span> <span class="kw">=</span> <span class="no">timeBegin</span>,
  <span class="kw">end</span> <span class="kw">=</span> <span class="no">timeEnd</span>)
<span class="co">## Warning in .validateListOrDfColOfStrings(sites, "sites"): Using the first column</span>
<span class="co">## of 'sites' as filter.</span>
<span class="co">## Warning in .validateListOrDfColOfStrings(phenomena, "phenomena"): Using the</span>
<span class="co">## first column of 'phenomena' as filter.</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">observationData</span>)
<span class="co">##                                     siteID       timestamp                  </span>
<span class="co">##  Wupper-Talsperre_Ablauf               :1419   Min.   :2018-01-01 00:00:00  </span>
<span class="co">##  Laaken                                :1416   1st Qu.:2018-01-15 17:00:00  </span>
<span class="co">##  Opladen                               :1416   Median :2018-01-30 11:00:00  </span>
<span class="co">##  Rutenbeck                             :1416   Mean   :2018-01-30 10:01:41  </span>
<span class="co">##  Grosse_Dhuenn-Talsperre_Absperrbauwerk: 118   3rd Qu.:2018-02-14 02:30:00  </span>
<span class="co">##  Schevelinger-Talsperre_Absperrbauwerk :  64   Max.   :2018-02-28 23:00:00  </span>
<span class="co">##  (Other)                               : 242                                </span>
<span class="co">##  Wassertemperatur</span>
<span class="co">##  Min.   : 0.000  </span>
<span class="co">##  1st Qu.: 4.600  </span>
<span class="co">##  Median : 5.700  </span>
<span class="co">##  Mean   : 6.056  </span>
<span class="co">##  3rd Qu.: 6.900  </span>
<span class="co">##  Max.   :12.900  </span>
<span class="co">## </span></pre></body></html></div>
<p>The result <code>data.frame</code> includes additional metadata.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">observationData</span><span class="kw">[[</span><span class="fl">3</span>]])
<span class="co">## $metadata</span>
<span class="co">## An object of class "WmlMeasurementTimeseriesMetadata"</span>
<span class="co">## Slot "temporalExtent":</span>
<span class="co">## GmlTimePeriod: [ GmlTimePosition [ time: 2018-01-02 11:00:00 ]</span>
<span class="co">##  --&gt; GmlTimePosition [ time: 2018-02-28 11:00:00 ] ] </span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $defaultPointMetadata</span>
<span class="co">## An object of class "WmlDefaultTVPMeasurementMetadata"</span>
<span class="co">## Slot "uom":</span>
<span class="co">## [1] "°C"</span>
<span class="co">## </span>
<span class="co">## Slot "interpolationType":</span>
<span class="co">## An object of class "WmlInterpolationType"</span>
<span class="co">## Slot "href":</span>
<span class="co">## [1] "http://www.opengis.net/def/timeseriesType/WaterML/2.0/continuous"</span>
<span class="co">## </span>
<span class="co">## Slot "title":</span>
<span class="co">## [1] "Instantaneous"</span></pre></body></html></div>
<p>As shown in the code, you can filter the results with objects created with other functions. The data returned can be limited by thematical, spatial, and temporal filters. Thematical filtering (phenomena) supports the values of the previous functions as inputs. Spatial filters are either sites, or a bounding box. A temporal filter is a time period during which observations are made. Without a temporal extent, the SOS only returns the last measurement.</p>
<p>Furthermore, the user can use spatial information about the sites and temporal information about the available phenomena and display sites on a map without having to touch coordinates or map projections. For example, the <code>fluggs_sites</code> object is a <code>SpatialPointsDataFrame</code> with a proper coordinate reference system (CRS).</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">fluggs_sites</span>@<span class="kw">proj4string</span>
<span class="co">## CRS arguments:</span>
<span class="co">##  +proj=tmerc +lat_0=0 +lon_0=6 +k=1 +x_0=2500000 +y_0=0 +ellps=bessel</span>
<span class="co">## +units=m +no_defs</span>
<span class="kw pkg">sp</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html">bbox</a></span>(<span class="no">fluggs_sites</span>)
<span class="co">##         min     max</span>
<span class="co">## lon 2569725 2610203</span>
<span class="co">## lat 5655230 5684705</span></pre></body></html></div>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mapview"</span>))
<span class="no">sites_map</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapView.html">mapview</a></span>(<span class="no">fluggs_sites</span>)
<span class="no">map_file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>(<span class="kw">fileext</span> <span class="kw">=</span> <span class="st">".png"</span>) <span class="co">#here::here("map.png")</span>
<span class="co"># requires phantomjs, webshot::install_phantomjs()</span>
<span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapshot.html">mapshot</a></span>(<span class="no">sites_map</span>, <span class="kw">file</span> <span class="kw">=</span> <span class="no">map_file</span>, <span class="kw">delay</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="no">map_file</span>)</pre></body></html></div>
<div class="figure" style="text-align: center">
<img src="../../../../../tmp/RtmpgKPHeP/file18f6e24e50d123.png" alt="Map of sites of Wupperverband SOS" width="496"><p class="caption">
Map of sites of Wupperverband SOS
</p>
</div>
</div>
<div id="integrated-data-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#integrated-data-analysis" class="anchor"></a>Integrated data analysis</h1>
<p>The abstraction provided by sos4R makes sensor observation data easily accessible across multiple SOS instances. It seamlessly integrates distributed observations data, i.e., across organizational boundaries, into transparent and reproducible data analysis workflows. These workflows can leverage the vast number of R packages for data science with geospatial and time series data.</p>
<p>Let’s plot the received data as time series:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"xts"</span>))
<span class="no">siteName</span> <span class="kw">=</span> <span class="st">"Schevelinger-Talsperre_Absperrbauwerk"</span>
<span class="no">dataColumn</span> <span class="kw">=</span> <span class="fl">3</span>
<span class="no">tsFluggs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html">xts</a></span>(
  <span class="no">observationData</span>[<span class="no">observationData</span>$<span class="no">siteID</span> <span class="kw">==</span> <span class="no">siteName</span>, <span class="no">dataColumn</span>],
  <span class="no">observationData</span>[<span class="no">observationData</span>$<span class="no">siteID</span> <span class="kw">==</span> <span class="no">siteName</span>, <span class="st">"timestamp"</span>])
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">tsFluggs</span>) <span class="kw">=</span> <span class="no">siteName</span>
<span class="no">unitOfMeasurement</span> <span class="kw">=</span> <span class="fu"><a href="../reference/SOS.html">sosUOM</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">observationData</span><span class="kw">[[</span><span class="no">dataColumn</span>]])$<span class="no">defaultPointMetadata</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">tsFluggs</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Water temperature ("</span>, <span class="no">unitOfMeasurement</span>, <span class="st">")"</span>),
     <span class="kw">sub</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(
       <span class="no">observationData</span><span class="kw">[[</span><span class="no">dataColumn</span>]]
       )$<span class="no">defaultPointMetadata</span>@<span class="kw">interpolationType</span>@<span class="kw">href</span>,
     <span class="kw">yaxis.right</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">legend.loc</span> <span class="kw">=</span> <span class="st">"topleft"</span>)</pre></body></html></div>
<p><img src="sos4R-vignette-10-egu-2020_files/figure-html/getData_timeseries_plot-1.png" width="576"></p>
<p>It is now straightforward to combine and visualize data from two different SOS servers. In this example, we’ll just combine water temperature from Germany and New Zealand.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">niwa</span> <span class="kw">=</span> <span class="fu"><a href="../reference/SOS.html">SOS</a></span>(
  <span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://hydro-sos.niwa.co.nz/"</span>,
  <span class="kw">binding</span> <span class="kw">=</span> <span class="st">"KVP"</span>,
  <span class="kw">useDCPs</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">version</span> <span class="kw">=</span> <span class="st">"2.0.0"</span>)
<span class="no">siteList</span> <span class="kw">=</span> <span class="fu"><a href="../reference/siteList.html">siteList</a></span>(<span class="kw">sos</span> <span class="kw">=</span> <span class="no">niwa</span>)
<span class="no">phenomenaNiwa</span> <span class="kw">=</span> <span class="fu"><a href="../reference/phenomena.html">phenomena</a></span>(<span class="kw">sos</span> <span class="kw">=</span> <span class="no">niwa</span>)

<span class="no">observationDataNiwa</span> <span class="kw">=</span> <span class="fu"><a href="../reference/getData.html">getData</a></span>(<span class="kw">sos</span> <span class="kw">=</span> <span class="no">niwa</span>,
  <span class="kw">phenomena</span> <span class="kw">=</span> <span class="no">phenomenaNiwa</span>[<span class="fl">25</span>, <span class="fl">1</span>],
  <span class="kw">sites</span> <span class="kw">=</span> <span class="no">siteList</span>$<span class="no">siteID</span>[<span class="fl">40</span>],
  <span class="kw">begin</span> <span class="kw">=</span> <span class="no">timeBegin</span>,
  <span class="kw">end</span> <span class="kw">=</span> <span class="no">timeEnd</span>)
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">observationDataNiwa</span><span class="kw">[[</span><span class="fl">3</span>]])
<span class="co">## $metadata</span>
<span class="co">## An object of class "WmlMeasurementTimeseriesMetadata"</span>
<span class="co">## Slot "temporalExtent":</span>
<span class="co">## GmlTimePeriod: [ GmlTimePosition [ time: 2018-01-10 21:15:00 ]</span>
<span class="co">##  --&gt; GmlTimePosition [ time: 2018-02-04 20:30:00 ] ] </span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $defaultPointMetadata</span>
<span class="co">## An object of class "WmlDefaultTVPMeasurementMetadata"</span>
<span class="co">## Slot "uom":</span>
<span class="co">## [1] "degC"</span>
<span class="co">## </span>
<span class="co">## Slot "interpolationType":</span>
<span class="co">## An object of class "WmlInterpolationType"</span>
<span class="co">## Slot "href":</span>
<span class="co">## [1] "http://www.opengis.net/def/timeseriesType/WaterML/2.0/continuous"</span>
<span class="co">## </span>
<span class="co">## Slot "title":</span>
<span class="co">## [1] "Instantaneous"</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">observationDataNiwa</span>)
<span class="co">##     siteID            timestamp                    Temperature  </span>
<span class="co">##  Length:2           Min.   :2018-01-10 21:15:00   Min.   :18.9  </span>
<span class="co">##  Class :character   1st Qu.:2018-01-17 03:03:45   1st Qu.:19.8  </span>
<span class="co">##  Mode  :character   Median :2018-01-23 08:52:30   Median :20.7  </span>
<span class="co">##                     Mean   :2018-01-23 08:52:30   Mean   :20.7  </span>
<span class="co">##                     3rd Qu.:2018-01-29 14:41:15   3rd Qu.:21.6  </span>
<span class="co">##                     Max.   :2018-02-04 20:30:00   Max.   :22.5</span></pre></body></html></div>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">ts1056</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html">xts</a></span>(<span class="no">observationDataNiwa</span>[<span class="no">observationDataNiwa</span>$<span class="no">siteID</span> <span class="kw">==</span> <span class="st">'AK1'</span>, <span class="fl">3</span>],
             <span class="no">observationDataNiwa</span>[<span class="no">observationDataNiwa</span>$<span class="no">siteID</span> <span class="kw">==</span> <span class="st">'AK1'</span>,<span class="st">"timestamp"</span>])
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">ts1056</span>) <span class="kw">=</span> <span class="st">"Station#AK1 @ NIWA"</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="fu">na.fill</span>(<span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">tsFluggs</span>, <span class="no">ts1056</span>), <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fl">NA</span>, <span class="st">"extend"</span>, <span class="fl">NA</span>)),
  <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Incomparable temperatures"</span>,
  <span class="kw">yaxis.right</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">legend.loc</span> <span class="kw">=</span> <span class="st">'topleft'</span>)</pre></body></html></div>
<p><img src="sos4R-vignette-10-egu-2020_files/figure-html/multiple_timeseries_plot-1.png" width="576"></p>
</div>
<div id="shiny-application" class="section level1">
<h1 class="hasAnchor">
<a href="#shiny-application" class="anchor"></a>Shiny application</h1>
<p>We also illustrate the use of the sos4R package in a simple, yet easily extensible <a href="https://shiny.rstudio.com/">Shiny</a> web application. By default, the application queries a SOS service operated by the Wupperverband (see <code>fluggs</code> SOS above). This SOS provides various hydrological time series. Upon start-up, the app portrays all measurement stations reporting data in a given time window on a map (see screenshot below). The user can interactively change this time window in the sidebar on the left hand side of the user interface. After the user selects a single station on the map, a list with the phenomena available appears in the sidebar and the app downloads the data for the given period. The data retrieved is converted into an <a href="https://cran.r-project.org/package=xts"><code>xts</code> object</a> and shown as a plot beneath the map window. The user can select one or more phenomena and the app will automatically update the plot with the newly retrieved data.</p>
<p>You can try out the app online at <strong><a href="http://pilot.52north.org/shinyApps/sos4R/">http://pilot.52north.org/shinyApps/sos4R/</a></strong>. The app’s source code, merely three function calls of sos4R wrapped in a simple graphical user interface, is <a href="https://github.com/52North/sos4R/tree/master/inst/shiny">part of the sos4R package</a>.</p>
<div class="figure">
<img src="sos4R-vignette-10-egu-2020_shiny-app.jpg" alt=""><p class="caption">Shiny sos4R app screenshot</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Nüst D., Stasch C., Pebesma E. (2011) Connecting R to the Sensor Web. In: Geertman S., Reinhardt W., Toppen F. (eds) Advancing Geoinformation Science for a Changing World. Lecture Notes in Geoinformation and Cartography, Springer. doi: <a href="https://doi.org/10.1007/978-3-642-19789-5_12">10.1007/978-3-642-19789-5_12</a></p>
<p>Pebesma, E., Nüst, D., &amp; Bivand, R. (2012). The R software environment in reproducible geoscientific research. Eos, Transactions American Geophysical Union, 93(16), 163–163. doi: <a href="https://doi.org/10.1029/2012EO160003">10.1029/2012EO160003</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Nuest, Ben Graeler, Benjamin Pross, Eike Hinderk Juerrens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
